# ğŸ“š PyRefPmid: Markdown PubMed Referencer (v2.2.0)

**PyRefPmid** ã¯ã€Markdown åŸç¨¿å†…ã® PubMed ID (PMID) ã‚’è‡ªå‹•æ¤œå‡ºã—ã€PubMed API ã‹ã‚‰æ›¸èªŒæƒ…å ±ã‚’å–å¾—ã—ã¦å‚è€ƒæ–‡çŒ®ãƒªã‚¹ãƒˆ (References) ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

ã‹ã¤ã¦ç ”ç©¶è€…ã«æ„›ç”¨ã•ã‚Œã¦ã„ãŸãƒ„ãƒ¼ãƒ«ã€ŒQRefã€ã®åˆ©ä¾¿æ€§ã‚’ã€ç¾ä»£ã® Markdown åŸ·ç­†ç’°å¢ƒã«ãŠã„ã¦å†ç¾ãƒ»ç°¡ç•¥åŒ–ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦é–‹ç™ºã•ã‚Œã¾ã—ãŸã€‚è«–æ–‡åŸ·ç­†ã«ãŠã„ã¦ã€è«–æ–‡åŸç¨¿ç”¨ Markdown ãƒ•ã‚¡ã‚¤ãƒ«å†…ã« PMID ã‚¿ã‚°ã‚’åŸ‹ã‚è¾¼ã‚€ã ã‘ã§å¼•ç”¨ç•ªå·ã®ä»˜ä¸ã¨æ–‡çŒ®ãƒªã‚¹ãƒˆã®ä½œæˆã‚’ä¸€æ‹¬ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½

- ğŸ“‚ **ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ**: ãƒ•ã‚©ãƒ«ãƒ€å†…ã® Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æ¤œå‡ºã—ã¾ã™ã€‚è¤‡æ•°ã‚ã‚‹å ´åˆã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰é¸æŠã§ãã€GUI ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚
- ğŸ”„ **PMID æŠ½å‡º & å¼•ç”¨ç½®æ›**: `[pm 12345678]()` å½¢å¼ã®è¨˜è¿°ã‚’æ¤œå‡ºã—ã€`(1)` ãªã©ã®å¼•ç”¨ç•ªå·ã«è‡ªå‹•ç½®æ›ã—ã¾ã™ã€‚
- ğŸ“¡ **æ›¸èªŒæƒ…å ±å–å¾— & ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: PubMed API ã‹ã‚‰è«–æ–‡æƒ…å ±ã‚’å–å¾—ã—ã€`paper.json` ã¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã§é«˜é€ŸåŒ–ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚
- ğŸ“‹ **å‚è€ƒæ–‡çŒ®ãƒªã‚¹ãƒˆç”Ÿæˆ (Clean Regeneration)**: `References` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆãƒ»æ›´æ–°ã—ã¾ã™ã€‚å†ç”Ÿæˆæ™‚ã¯å¸¸ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œã‚‹ãŸã‚ã€å¤ã„æƒ…å ±ãŒæ®‹ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
- âš¡ **é«˜é€Ÿãªä¸¦åˆ—å‡¦ç†**: ä¸¦åˆ—ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨è‡ªå‹•ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«ã‚ˆã‚Šã€å¤§é‡ã®æ–‡çŒ®ã‚‚æ•°ç§’ã§å–å¾—å¯èƒ½ã§ã™ã€‚
- ğŸ”— **å¼•ç”¨ç¯„å›²ã®åœ§ç¸®**: `1,2,3` ã®ã‚ˆã†ãªé€£ç¶šã™ã‚‹ç•ªå·ã‚’ `1-3` ã¨è‡ªå‹•ã§åœ§ç¸®æ•´å½¢ã—ã¾ã™ã€‚
- ğŸ¨ **é«˜åº¦ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®š**: è‘—è€…åã®è¡¨è¨˜ï¼ˆ`Fujita M` vs `Fujita, M.`ï¼‰ã‚„å¼•ç”¨å½¢å¼ã‚’æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ã§ã™ã€‚

## ğŸ“¦ å¿…è¦ãªã‚‚ã®

- Python 3.7+
- `requests` ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (`pip install requests`)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

æœ¬ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å˜ä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§å‹•ä½œã—ã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã§ã€ä»»æ„ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚

### ğŸ åŸºæœ¬çš„ãªå®Ÿè¡Œ

```bash
python PyRefPmid.py
```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãŒ1ã¤ã ã‘**ã®å ´åˆ: è‡ªå‹•çš„ã«å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚
- **è¤‡æ•°ã‚ã‚‹å ´åˆ**: å¯¾è©±ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¾ãŸã¯ GUI ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚

å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¨ã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã« `_cited` ãŒä»˜ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹: `draft_cited.md`ï¼‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### âœï¸ åŸç¨¿å†…ã§ã®è¨˜è¿°æ–¹æ³•

Markdown å†…ã§ä»¥ä¸‹ã®ã‚ˆã†ã« PMID ã‚’è¨˜è¿°ã—ã¾ã™ï¼ˆå¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ãªã—ã€`[pmid 12345678]` å½¢å¼ã‚‚å¯ï¼‰ã€‚

- **ãƒªãƒ³ã‚¯å½¢å¼**: `[pm 12345678]()` ï¼ˆURL éƒ¨åˆ† `()` ã¯ç„¡è¦–ã•ã‚Œã¾ã™ï¼‰
- **ã‚¿ã‚°å½¢å¼**: `[pm 12345678]`

```markdown
ã“ã®ç ”ç©¶ã¯é‡è¦ã§ã™ [pm 12345678]()ã€‚
ã‚¿ã‚°å½¢å¼ [pm 87654321] ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
```

å®Ÿè¡Œå¾Œ:
```markdown
ã“ã®ç ”ç©¶ã¯é‡è¦ã§ã™ (1)ã€‚
ã‚¿ã‚°å½¢å¼ (2) ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

... (æœ«å°¾)
# References

1. Authors... Title... (12345678)
2. Authors... Title... (87654321)
```

### âš™ï¸ ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³

å¼•æ•°ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€å‹•ä½œã‚’è©³ç´°ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

```bash
python PyRefPmid.py [å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«] [ã‚ªãƒ—ã‚·ãƒ§ãƒ³]
```

#### ğŸ› ï¸ åŸºæœ¬ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- **`input_file`** (ä½ç½®å¼•æ•°)
  - å‡¦ç†å¯¾è±¡ã® Markdown ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: çœç•¥æ™‚ã¯å®Ÿè¡Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã§ `.md` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æ¤œç´¢ã—ã¾ã™ã€‚
- **`-o`, `--output-file`**
  - å‡¦ç†çµæœã®ä¿å­˜å…ˆãƒ‘ã‚¹ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `[å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«å]_cited.md`
- **`--no-cache`**
  - ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’ä½¿ç”¨ã›ãšã€å¸¸ã« API ã‹ã‚‰æœ€æ–°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ğŸ¨ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®š
- **`--author-name-format`**
  - è‘—è€…åã®è¡¨ç¤ºå½¢å¼ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `{name}` (PubMed API ã®ç”Ÿãƒ‡ãƒ¼ã‚¿: ä¾‹ `Smith J`)
  - **ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼**: `{last}` (å§“), `{initials}` (ã‚¤ãƒ‹ã‚·ãƒ£ãƒ«), `{name}` (å§“å)
  - **ä¾‹**: `"{last}, {initials}."` -> `Smith, J.`
- **`--citation-format`**
  - æœ¬æ–‡ä¸­ã®å¼•ç”¨ãƒ©ãƒ™ãƒ«ã®å½¢å¼ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `({number})`
  - **ä¾‹**: `[{number}]` -> `[1]`
- **`--ref-item-format`**
  - å‚è€ƒæ–‡çŒ®ãƒªã‚¹ãƒˆã®å„é …ç›®ã®è¡¨ç¤ºãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `{number}. {authors}. {title} {journal} {year};{volume}:{pages}. doi: {doi}. [{pmid}](...)`
  - **ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼**: `{number}`, `{authors}`, `{title}`, `{journal}`, `{year}`, `{volume}`, `{issue}`, `{pages}`, `{doi}`, `{pmid}`
- **`--author-threshold`**
  - å‚è€ƒæ–‡çŒ®ãƒªã‚¹ãƒˆã«è¡¨ç¤ºã™ã‚‹è‘—è€…ã®æœ€å¤§æ•°ã€‚ã“ã®æ•°ã‚’è¶…ãˆã‚‹ã¨ `et al` ã§çœç•¥ã•ã‚Œã¾ã™ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `0` (å…¨å“¡è¡¨ç¤º)
- **`--author-display`**
  - `--author-threshold` ã‚’è¶…éã—ãŸå ´åˆã«å®Ÿéš›ã«è¡¨ç¤ºã™ã‚‹è‘—è€…æ•°ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `0` (`--author-threshold` ã¨åŒã˜æ•°ã‚’è¡¨ç¤º)
  - **ä¾‹**: `--author-threshold 6 --author-display 3` â†’ è‘—è€…6äººä»¥ä¸Šã®å ´åˆã€æœ€åˆã®3äºº + et al
- **`--references-header`**
  - å‚è€ƒæ–‡çŒ®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¦‹å‡ºã—ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `References`

#### ğŸ”§ é«˜åº¦ãªè¨­å®š
- **`--api-key`**
  - PubMed (NCBI) ã® API ã‚­ãƒ¼ã€‚æŒ‡å®šã™ã‚‹ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ãŒç·©å’Œã•ã‚Œã€å‡¦ç†ãŒé«˜é€ŸåŒ–ã—ã¾ã™ã€‚
- **`--pmid-regex`**
  - PMID ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã®æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚
- **`--cache-file`**
  - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ãƒ‘ã‚¹ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `[å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«å].json`
- **`--max-workers`**
  - ä¸¦åˆ—å–å¾—ã«ä½¿ç”¨ã™ã‚‹æœ€å¤§ã‚¹ãƒ¬ãƒƒãƒ‰æ•°ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `5`


## ğŸ§‘â€ğŸ’» ä½œè€… (Author)

- **mfujita47 (Mitsugu Fujita)** - [https://github.com/mfujita47](https://github.com/mfujita47)

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[MIT License](LICENSE)

## ğŸ“œ å¤‰æ›´å±¥æ­´

è©³ç´°ã¯ [CHANGELOG.md](CHANGELOG.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
