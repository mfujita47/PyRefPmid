---
applyTo: "*.py"
---

# Copilot による Python リファクタリング指示書

## 目的

このドキュメントは、Python スクリプトのリファクタリングに関する指示をまとめたものです。
Copilot は以下の指示に従い、既存の Python コードをより可読性が高く、保守性に優れ、効率的なものに改善してください。

## 全般的な指示

- **元の機能の維持**: リファクタリングによって、コードの既存の機能やロジックが変更されないようにしてください。
- **段階的な変更**: 大規模な変更を行う場合は、複数の小さなステップに分割して提案してください。
- **変更意図の明確化**: 必要な場合は、なぜその変更を行ったのか、コメントや説明を追加してください。

## リファクタリングの具体的な指示

### 1. 可読性の向上

- **命名規則**:
  - 変数名、関数名、クラス名は、その役割や内容が明確にわかるように、具体的かつ適切な長さにしてください。
  - Python の標準的な命名規則（PEP 8）に従ってください（例: 関数名と変数名はスネークケース `snake_case`、クラス名はキャメルケース `ClassName`）。
- **コメント**:
  - 複雑なロジックやアルゴリズム、理解が難しい箇所には、処理内容を説明するコメントを追加してください。
  - 各関数・メソッドには、その目的、引数、戻り値を説明する docstring を適切な形式（例: Google スタイル、Numpy スタイル）で記述してください。
  - 不要なコメントや古いコメントは削除してください。
- **コードの構造化**:
  - 長すぎる関数やメソッドは、単一責任の原則に基づいて、より小さく論理的な単位に分割してください。
  - 関連するデータとそれを操作する関数は、クラスとしてまとめることを検討してください。
  - ネストが深すぎる条件分岐やループは、早期リターンや関数の抽出などで簡略化してください。
- **空白とフォーマット**:
  - PEP 8 に準拠したインデント（スペース 4 つ）、行間、演算子周りのスペースなどを適切に使用し、コードの視認性を高めてください。
  - 一貫性のあるフォーマットを適用してください。

### 2. 保守性の向上

- **マジックナンバーの排除**: コード内に直接記述された数値（マジックナンバー）は、意味のわかる名前を持つ定数として定義し、それを使用するように変更してください。
- **DRY (Don't Repeat Yourself) 原則**: 繰り返し現れるコードブロックは、関数やメソッドとして共通化し、重複を排除してください。
- **型ヒント**:
  - 関数の引数、戻り値、および重要な変数には、型ヒント（Type Hinting）を追加してください。これにより、コードの理解と静的解析が容易になります。
- **設定値の分離**: ハードコードされた設定値（ファイルパス、API キーなど）は、設定ファイルや環境変数から読み込むように変更することを検討してください。

### 3. パフォーマンスと効率

- **冗長な処理の削除**: 不要な計算や冗長なコードは削除してください。
- **効率的なデータ構造とアルゴリズム**: より効率的なデータ構造やアルゴリズムが適用できる場合は、その変更を提案してください。ただし、可読性を著しく損なわない範囲でお願いします。
- **Pythonic な書き方**: Python の組み込み関数や標準ライブラリを効果的に活用し、より Pythonic で簡潔なコードにしてください（例: `map`, `filter`, `list comprehensions` の活用）。

### 4. エラーハンドリング

- 潜在的なエラー（例: ファイル IO、ネットワークアクセス、不正な入力）に対して、適切な例外処理（`try-except`ブロック）を追加してください。
- エラーメッセージは具体的で、問題解決に役立つものにしてください。

## 適用範囲

- この指示は、リファクタリング対象として選択された Python スクリプト全体、または特定の範囲に対して適用してください。

Copilot はこれらの指示を参考に、より質の高い Python コードへの改善にご協力ください。
